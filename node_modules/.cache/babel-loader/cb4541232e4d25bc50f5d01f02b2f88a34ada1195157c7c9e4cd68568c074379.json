{"ast":null,"code":"import React,{createContext,useState,useContext,useEffect}from'react';import axios from'axios';import{jsx as _jsx}from\"react/jsx-runtime\";const AuthContext=/*#__PURE__*/createContext(null);// Setup API base URL - will default to localhost for development\nconst API_URL=process.env.REACT_APP_API_URL||'http://localhost:8081';// Token storage key\nconst TOKEN_STORAGE_KEY='budget-tracker-token';const USER_STORAGE_KEY='budget-tracker-user';// Add the token to all axios requests\naxios.interceptors.request.use(config=>{const token=localStorage.getItem(TOKEN_STORAGE_KEY);if(token){config.headers['Authorization']=`Bearer ${token}`;}return config;},error=>{return Promise.reject(error);});export const AuthProvider=_ref=>{let{children}=_ref;const[currentUser,setCurrentUser]=useState(null);const[token,setToken]=useState(null);const[loading,setLoading]=useState(true);// On init, check for saved token and user\nuseEffect(()=>{const storedToken=localStorage.getItem(TOKEN_STORAGE_KEY);const storedUser=localStorage.getItem(USER_STORAGE_KEY);if(storedToken&&storedUser){try{setToken(storedToken);setCurrentUser(JSON.parse(storedUser));}catch(error){console.error('Failed to parse stored user data',error);// Clear invalid data\nlocalStorage.removeItem(TOKEN_STORAGE_KEY);localStorage.removeItem(USER_STORAGE_KEY);}}setLoading(false);},[]);// Save user and token data when they change\nuseEffect(()=>{if(currentUser&&token){localStorage.setItem(USER_STORAGE_KEY,JSON.stringify(currentUser));localStorage.setItem(TOKEN_STORAGE_KEY,token);}else{localStorage.removeItem(USER_STORAGE_KEY);localStorage.removeItem(TOKEN_STORAGE_KEY);}},[currentUser,token]);const login=async(email,password)=>{setLoading(true);try{const response=await axios.post(`${API_URL}/api/auth/login`,{email,password});const{token,user}=response.data;setToken(token);setCurrentUser({id:user.id,username:user.username,email:user.email});setLoading(false);return true;}catch(error){console.error('Login error:',error);setLoading(false);return false;}};const register=async(username,email,password)=>{setLoading(true);try{const response=await axios.post(`${API_URL}/api/auth/register`,{username,email,password});const{token,user}=response.data;setToken(token);setCurrentUser({id:user.id,username:user.username,email:user.email});setLoading(false);return true;}catch(error){console.error('Registration error:',error);// Check if we have a specific error message from the server\nif(error.response&&error.response.data&&error.response.data.message){console.error('Server error message:',error.response.data.message);}setLoading(false);return false;}};const logout=()=>{setCurrentUser(null);setToken(null);};return/*#__PURE__*/_jsx(AuthContext.Provider,{value:{currentUser,isAuthenticated:!!currentUser&&!!token,login,register,logout,loading,token},children:children});};export const useAuth=()=>{const context=useContext(AuthContext);if(!context){throw new Error('useAuth must be used within an AuthProvider');}return context;};","map":{"version":3,"names":["React","createContext","useState","useContext","useEffect","axios","jsx","_jsx","AuthContext","API_URL","process","env","REACT_APP_API_URL","TOKEN_STORAGE_KEY","USER_STORAGE_KEY","interceptors","request","use","config","token","localStorage","getItem","headers","error","Promise","reject","AuthProvider","_ref","children","currentUser","setCurrentUser","setToken","loading","setLoading","storedToken","storedUser","JSON","parse","console","removeItem","setItem","stringify","login","email","password","response","post","user","data","id","username","register","message","logout","Provider","value","isAuthenticated","useAuth","context","Error"],"sources":["C:/Users/Administrator/Downloads/personal-budget-tracker v2/personal-budget-tracker/src/context/AuthContext.tsx"],"sourcesContent":["import React, { createContext, useState, useContext, useEffect, ReactNode } from 'react';\nimport axios from 'axios';\n\ninterface User {\n  id: string;\n  username: string;\n  email: string;\n}\n\ninterface AuthContextType {\n  currentUser: User | null;\n  isAuthenticated: boolean;\n  login: (email: string, password: string) => Promise<boolean>;\n  register: (username: string, email: string, password: string) => Promise<boolean>;\n  logout: () => void;\n  loading: boolean;\n  token: string | null;\n}\n\nconst AuthContext = createContext<AuthContextType | null>(null);\n\n// Setup API base URL - will default to localhost for development\nconst API_URL = process.env.REACT_APP_API_URL || 'http://localhost:8081';\n\n// Token storage key\nconst TOKEN_STORAGE_KEY = 'budget-tracker-token';\nconst USER_STORAGE_KEY = 'budget-tracker-user';\n\n// Add the token to all axios requests\naxios.interceptors.request.use(\n  (config) => {\n    const token = localStorage.getItem(TOKEN_STORAGE_KEY);\n    if (token) {\n      config.headers['Authorization'] = `Bearer ${token}`;\n    }\n    return config;\n  },\n  (error) => {\n    return Promise.reject(error);\n  }\n);\n\nexport const AuthProvider: React.FC<{ children: ReactNode }> = ({ children }) => {\n  const [currentUser, setCurrentUser] = useState<User | null>(null);\n  const [token, setToken] = useState<string | null>(null);\n  const [loading, setLoading] = useState(true);\n\n  // On init, check for saved token and user\n  useEffect(() => {\n    const storedToken = localStorage.getItem(TOKEN_STORAGE_KEY);\n    const storedUser = localStorage.getItem(USER_STORAGE_KEY);\n    \n    if (storedToken && storedUser) {\n      try {\n        setToken(storedToken);\n        setCurrentUser(JSON.parse(storedUser));\n      } catch (error) {\n        console.error('Failed to parse stored user data', error);\n        // Clear invalid data\n        localStorage.removeItem(TOKEN_STORAGE_KEY);\n        localStorage.removeItem(USER_STORAGE_KEY);\n      }\n    }\n    setLoading(false);\n  }, []);\n\n  // Save user and token data when they change\n  useEffect(() => {\n    if (currentUser && token) {\n      localStorage.setItem(USER_STORAGE_KEY, JSON.stringify(currentUser));\n      localStorage.setItem(TOKEN_STORAGE_KEY, token);\n    } else {\n      localStorage.removeItem(USER_STORAGE_KEY);\n      localStorage.removeItem(TOKEN_STORAGE_KEY);\n    }\n  }, [currentUser, token]);\n\n  const login = async (email: string, password: string): Promise<boolean> => {\n    setLoading(true);\n    \n    try {\n      const response = await axios.post(`${API_URL}/api/auth/login`, { email, password });\n      const { token, user } = response.data;\n      \n      setToken(token);\n      setCurrentUser({\n        id: user.id,\n        username: user.username,\n        email: user.email\n      });\n      \n      setLoading(false);\n      return true;\n    } catch (error) {\n      console.error('Login error:', error);\n      setLoading(false);\n      return false;\n    }\n  };\n\n  const register = async (username: string, email: string, password: string): Promise<boolean> => {\n    setLoading(true);\n    \n    try {\n      const response = await axios.post(`${API_URL}/api/auth/register`, { username, email, password });\n      const { token, user } = response.data;\n      \n      setToken(token);\n      setCurrentUser({\n        id: user.id,\n        username: user.username,\n        email: user.email\n      });\n      \n      setLoading(false);\n      return true;\n    } catch (error: any) {\n      console.error('Registration error:', error);\n      // Check if we have a specific error message from the server\n      if (error.response && error.response.data && error.response.data.message) {\n        console.error('Server error message:', error.response.data.message);\n      }\n      setLoading(false);\n      return false;\n    }\n  };\n\n  const logout = () => {\n    setCurrentUser(null);\n    setToken(null);\n  };\n\n  return (\n    <AuthContext.Provider\n      value={{\n        currentUser,\n        isAuthenticated: !!currentUser && !!token,\n        login,\n        register,\n        logout,\n        loading,\n        token\n      }}\n    >\n      {children}\n    </AuthContext.Provider>\n  );\n};\n\nexport const useAuth = (): AuthContextType => {\n  const context = useContext(AuthContext);\n  if (!context) {\n    throw new Error('useAuth must be used within an AuthProvider');\n  }\n  return context;\n}; "],"mappings":"AAAA,MAAO,CAAAA,KAAK,EAAIC,aAAa,CAAEC,QAAQ,CAAEC,UAAU,CAAEC,SAAS,KAAmB,OAAO,CACxF,MAAO,CAAAC,KAAK,KAAM,OAAO,CAAC,OAAAC,GAAA,IAAAC,IAAA,yBAkB1B,KAAM,CAAAC,WAAW,cAAGP,aAAa,CAAyB,IAAI,CAAC,CAE/D;AACA,KAAM,CAAAQ,OAAO,CAAGC,OAAO,CAACC,GAAG,CAACC,iBAAiB,EAAI,uBAAuB,CAExE;AACA,KAAM,CAAAC,iBAAiB,CAAG,sBAAsB,CAChD,KAAM,CAAAC,gBAAgB,CAAG,qBAAqB,CAE9C;AACAT,KAAK,CAACU,YAAY,CAACC,OAAO,CAACC,GAAG,CAC3BC,MAAM,EAAK,CACV,KAAM,CAAAC,KAAK,CAAGC,YAAY,CAACC,OAAO,CAACR,iBAAiB,CAAC,CACrD,GAAIM,KAAK,CAAE,CACTD,MAAM,CAACI,OAAO,CAAC,eAAe,CAAC,CAAG,UAAUH,KAAK,EAAE,CACrD,CACA,MAAO,CAAAD,MAAM,CACf,CAAC,CACAK,KAAK,EAAK,CACT,MAAO,CAAAC,OAAO,CAACC,MAAM,CAACF,KAAK,CAAC,CAC9B,CACF,CAAC,CAED,MAAO,MAAM,CAAAG,YAA+C,CAAGC,IAAA,EAAkB,IAAjB,CAAEC,QAAS,CAAC,CAAAD,IAAA,CAC1E,KAAM,CAACE,WAAW,CAAEC,cAAc,CAAC,CAAG5B,QAAQ,CAAc,IAAI,CAAC,CACjE,KAAM,CAACiB,KAAK,CAAEY,QAAQ,CAAC,CAAG7B,QAAQ,CAAgB,IAAI,CAAC,CACvD,KAAM,CAAC8B,OAAO,CAAEC,UAAU,CAAC,CAAG/B,QAAQ,CAAC,IAAI,CAAC,CAE5C;AACAE,SAAS,CAAC,IAAM,CACd,KAAM,CAAA8B,WAAW,CAAGd,YAAY,CAACC,OAAO,CAACR,iBAAiB,CAAC,CAC3D,KAAM,CAAAsB,UAAU,CAAGf,YAAY,CAACC,OAAO,CAACP,gBAAgB,CAAC,CAEzD,GAAIoB,WAAW,EAAIC,UAAU,CAAE,CAC7B,GAAI,CACFJ,QAAQ,CAACG,WAAW,CAAC,CACrBJ,cAAc,CAACM,IAAI,CAACC,KAAK,CAACF,UAAU,CAAC,CAAC,CACxC,CAAE,MAAOZ,KAAK,CAAE,CACde,OAAO,CAACf,KAAK,CAAC,kCAAkC,CAAEA,KAAK,CAAC,CACxD;AACAH,YAAY,CAACmB,UAAU,CAAC1B,iBAAiB,CAAC,CAC1CO,YAAY,CAACmB,UAAU,CAACzB,gBAAgB,CAAC,CAC3C,CACF,CACAmB,UAAU,CAAC,KAAK,CAAC,CACnB,CAAC,CAAE,EAAE,CAAC,CAEN;AACA7B,SAAS,CAAC,IAAM,CACd,GAAIyB,WAAW,EAAIV,KAAK,CAAE,CACxBC,YAAY,CAACoB,OAAO,CAAC1B,gBAAgB,CAAEsB,IAAI,CAACK,SAAS,CAACZ,WAAW,CAAC,CAAC,CACnET,YAAY,CAACoB,OAAO,CAAC3B,iBAAiB,CAAEM,KAAK,CAAC,CAChD,CAAC,IAAM,CACLC,YAAY,CAACmB,UAAU,CAACzB,gBAAgB,CAAC,CACzCM,YAAY,CAACmB,UAAU,CAAC1B,iBAAiB,CAAC,CAC5C,CACF,CAAC,CAAE,CAACgB,WAAW,CAAEV,KAAK,CAAC,CAAC,CAExB,KAAM,CAAAuB,KAAK,CAAG,KAAAA,CAAOC,KAAa,CAAEC,QAAgB,GAAuB,CACzEX,UAAU,CAAC,IAAI,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAY,QAAQ,CAAG,KAAM,CAAAxC,KAAK,CAACyC,IAAI,CAAC,GAAGrC,OAAO,iBAAiB,CAAE,CAAEkC,KAAK,CAAEC,QAAS,CAAC,CAAC,CACnF,KAAM,CAAEzB,KAAK,CAAE4B,IAAK,CAAC,CAAGF,QAAQ,CAACG,IAAI,CAErCjB,QAAQ,CAACZ,KAAK,CAAC,CACfW,cAAc,CAAC,CACbmB,EAAE,CAAEF,IAAI,CAACE,EAAE,CACXC,QAAQ,CAAEH,IAAI,CAACG,QAAQ,CACvBP,KAAK,CAAEI,IAAI,CAACJ,KACd,CAAC,CAAC,CAEFV,UAAU,CAAC,KAAK,CAAC,CACjB,MAAO,KAAI,CACb,CAAE,MAAOV,KAAK,CAAE,CACde,OAAO,CAACf,KAAK,CAAC,cAAc,CAAEA,KAAK,CAAC,CACpCU,UAAU,CAAC,KAAK,CAAC,CACjB,MAAO,MAAK,CACd,CACF,CAAC,CAED,KAAM,CAAAkB,QAAQ,CAAG,KAAAA,CAAOD,QAAgB,CAAEP,KAAa,CAAEC,QAAgB,GAAuB,CAC9FX,UAAU,CAAC,IAAI,CAAC,CAEhB,GAAI,CACF,KAAM,CAAAY,QAAQ,CAAG,KAAM,CAAAxC,KAAK,CAACyC,IAAI,CAAC,GAAGrC,OAAO,oBAAoB,CAAE,CAAEyC,QAAQ,CAAEP,KAAK,CAAEC,QAAS,CAAC,CAAC,CAChG,KAAM,CAAEzB,KAAK,CAAE4B,IAAK,CAAC,CAAGF,QAAQ,CAACG,IAAI,CAErCjB,QAAQ,CAACZ,KAAK,CAAC,CACfW,cAAc,CAAC,CACbmB,EAAE,CAAEF,IAAI,CAACE,EAAE,CACXC,QAAQ,CAAEH,IAAI,CAACG,QAAQ,CACvBP,KAAK,CAAEI,IAAI,CAACJ,KACd,CAAC,CAAC,CAEFV,UAAU,CAAC,KAAK,CAAC,CACjB,MAAO,KAAI,CACb,CAAE,MAAOV,KAAU,CAAE,CACnBe,OAAO,CAACf,KAAK,CAAC,qBAAqB,CAAEA,KAAK,CAAC,CAC3C;AACA,GAAIA,KAAK,CAACsB,QAAQ,EAAItB,KAAK,CAACsB,QAAQ,CAACG,IAAI,EAAIzB,KAAK,CAACsB,QAAQ,CAACG,IAAI,CAACI,OAAO,CAAE,CACxEd,OAAO,CAACf,KAAK,CAAC,uBAAuB,CAAEA,KAAK,CAACsB,QAAQ,CAACG,IAAI,CAACI,OAAO,CAAC,CACrE,CACAnB,UAAU,CAAC,KAAK,CAAC,CACjB,MAAO,MAAK,CACd,CACF,CAAC,CAED,KAAM,CAAAoB,MAAM,CAAGA,CAAA,GAAM,CACnBvB,cAAc,CAAC,IAAI,CAAC,CACpBC,QAAQ,CAAC,IAAI,CAAC,CAChB,CAAC,CAED,mBACExB,IAAA,CAACC,WAAW,CAAC8C,QAAQ,EACnBC,KAAK,CAAE,CACL1B,WAAW,CACX2B,eAAe,CAAE,CAAC,CAAC3B,WAAW,EAAI,CAAC,CAACV,KAAK,CACzCuB,KAAK,CACLS,QAAQ,CACRE,MAAM,CACNrB,OAAO,CACPb,KACF,CAAE,CAAAS,QAAA,CAEDA,QAAQ,CACW,CAAC,CAE3B,CAAC,CAED,MAAO,MAAM,CAAA6B,OAAO,CAAGA,CAAA,GAAuB,CAC5C,KAAM,CAAAC,OAAO,CAAGvD,UAAU,CAACK,WAAW,CAAC,CACvC,GAAI,CAACkD,OAAO,CAAE,CACZ,KAAM,IAAI,CAAAC,KAAK,CAAC,6CAA6C,CAAC,CAChE,CACA,MAAO,CAAAD,OAAO,CAChB,CAAC","ignoreList":[]},"metadata":{},"sourceType":"module","externalDependencies":[]}